cex.lab = 1.5,     # axis label size
cex.axis = 1.3,    # tick number size
cex.main = 1.8 )
col_set <- rainbow(ncol(industry_means))  # Color palette
for (i in 1:ncol(industry_means)) {
lines(1:156, industry_means[, i], col = col_set[i], lwd = 2)
}
# Add legend
legend("bottomright", legend = colnames(industry_means),
col = col_set, lwd = 2, cex = 0.9)
industry_means <- t(sapply(1:nrow(data), function(i) {
tapply(data[i, ], groups, mean, na.rm = TRUE)
}))
plot(1:156, industry_means[, 1], type = "n",
ylim = range(industry_means, na.rm = TRUE),
xlab = "Week", ylab = "Mean Stock Price",
main = "Industry Mean Trajectories",
cex.lab = 1.5,     # axis label size
cex.axis = 1.3,    # tick number size
cex.main = 1.8 )
col_set <- rainbow(ncol(industry_means))  # Color palette
for (i in 1:ncol(industry_means)) {
lines(1:156, industry_means[, i], col = col_set[i], lwd = 2)
}
industry_means <- t(sapply(1:nrow(data), function(i) {
tapply(data[i, ], groups, mean, na.rm = TRUE)
}))
plot(1:156, industry_means[, 1], type = "n",
ylim = range(industry_means, na.rm = TRUE),
xlab = "Week", ylab = "Mean Stock Price",
main = "Industry Mean Trajectories",
cex.lab = 1.5,     # axis label size
cex.axis = 1.3,    # tick number size
cex.main = 1.8 )
col_set <- rainbow(ncol(industry_means))  # Color palette
for (i in 1:ncol(industry_means)) {
lines(1:156, industry_means[, i], col = col_set[i], lwd = 2)
}
# Add legend
legend("bottomright", legend = colnames(industry_means),
col = col_set, lwd = 2, cex = 0.9)
plot(1:156, industry_means[, 1], type = "n",
ylim = range(industry_means, na.rm = TRUE),
xlab = "Week", ylab = "Mean Stock Price",
main = "Industry Mean Trajectories",
cex.lab = 2,     # axis label size
cex.axis = 1.3,    # tick number size
cex.main = 1.8 )
tapply(data[i, ], groups, mean, na.rm = TRUE)
}))
industry_means <- t(sapply(1:nrow(data), function(i) {
tapply(data[i, ], groups, mean, na.rm = TRUE)
}))
plot(1:156, industry_means[, 1], type = "n",
ylim = range(industry_means, na.rm = TRUE),
xlab = "Week", ylab = "Mean Stock Price",
main = "Industry Mean Trajectories",
cex.lab = 2,     # axis label size
cex.axis = 1.3,    # tick number size
cex.main = 1.8 )
col_set <- rainbow(ncol(industry_means))  # Color palette
for (i in 1:ncol(industry_means)) {
lines(1:156, industry_means[, i], col = col_set[i], lwd = 2)
}
# Add legend
legend("bottomright", legend = colnames(industry_means),
col = col_set, lwd = 2, cex = 0.9)
plot(1:156, industry_means[, 1], type = "n",
ylim = range(industry_means, na.rm = TRUE),
xlab = "Week", ylab = "Mean Stock Price",
main = "Industry Mean Trajectories",
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2 )
col_set <- rainbow(ncol(industry_means))  # Color palette
for (i in 1:ncol(industry_means)) {
lines(1:156, industry_means[, i], col = col_set[i], lwd = 2)
}
# Add legend
legend("bottomright", legend = colnames(industry_means),
col = col_set, lwd = 2, cex = 0.9)
png("industry_mean_plot.png", width = 1200, height = 800, res = 150)
industry_means <- t(sapply(1:nrow(data), function(i) {
tapply(data[i, ], groups, mean, na.rm = TRUE)
}))
plot(1:156, industry_means[, 1], type = "n",
ylim = range(industry_means, na.rm = TRUE),
xlab = "Week", ylab = "Mean Stock Price",
main = "Industry Mean Trajectories",
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2 )
col_set <- rainbow(ncol(industry_means))  # Color palette
for (i in 1:ncol(industry_means)) {
lines(1:156, industry_means[, i], col = col_set[i], lwd = 2)
}
# Add legend
legend("bottomright", legend = colnames(industry_means),
col = col_set, lwd = 2, cex = 0.9)
dev.off()
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA: Industry Differences Over Time",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1))
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA: Industry Differences Over Time",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1))
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA: Industry Differences Over Time",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1))
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Significant significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA: Industry Differences Over Time",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Significant significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
png("industry_mean_plot.png", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA: Industry Differences Over Time",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 1.5)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Significant significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
png("ANOVA_1", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA: Industry Differences Over Time",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 1.5)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Significant significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
png("ANOVA_1", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA: Industry Differences Over Time",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 1.5)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Significant significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
png("ANOVA_1", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 1.5)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Significant significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
png("ANOVA_1", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 2)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Statistically significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
png("ANOVA_1", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 2)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Statistically significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
png("ANOVA_1", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 2)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Statistically significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
png("ANOVA_1", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 2)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Statistically significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
png("ANOVA_1", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 2)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Statistically significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
png("ANOVA_1.png", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 2)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Statistically significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
png("ANOVA_1.png", width = 1200, height = 800, res = 150)
plot(1:156, pvals, type = "l", lwd = 2, col = "darkred",
main = "Pointwise ANOVA",
xlab = "Time (weeks)", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 2)
pvals_adj <- p.adjust(pvals, method = "fdr")
# Highlight significant weeks (FDR-adjusted)
sig_weeks <- which(pvals_adj < alpha)
points(t.seq[sig_weeks], pvals[sig_weeks], col = "red", pch = 19, cex = 0.6)
legend("topright", legend = c("p-values", "Statistically significant "),
col = c("darkred", "red"), lwd = c(2, NA), pch = c(NA, 19), bty = "n")
dev.off()
opar2 <- par(mfrow = c(1, 1), ask = TRUE)
for (i in 1:perm) {
plot(t.seq, Tukey.posthoc[, i], type = "l", col = "purple", lwd = 2,
main = paste("Tukey HSD p-values for", colnames(Tukey.posthoc)[i]),
xlab = "Time", ylab = "p-value", ylim = c(0, 1))
abline(h = alpha, col = "blue", lty = 2, lwd = 2)
}
opar2 <- par(mfrow = c(1, 1))
# Loop over each permutation
for (i in 1:perm) {
# Set file name
png(filename = paste0("Tukey_plot_", i, ".png"), width = 800, height = 600)
# Make the plot
plot(t.seq, Tukey.posthoc[, i], type = "l", col = "purple", lwd = 2,
main = paste("Tukey HSD p-values for", colnames(Tukey.posthoc)[i]),
xlab = "Time", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2))
opar2 <- par(mfrow = c(1, 1))
# Loop over each permutation
for (i in 1:perm) {
# Set file name
png(filename = paste0("Tukey_plot_", i, ".png"), width = 800, height = 600)
# Make the plot
plot(t.seq, Tukey.posthoc[, i], type = "l", col = "purple", lwd = 2,
main = paste("Tukey HSD p-values for", colnames(Tukey.posthoc)[i]),
xlab = "Time", ylab = "p-value", ylim = c(0, 1),
cex.lab = 1.8,     # axis label size
cex.axis = 1.5,    # tick number size
cex.main = 2)
abline(h = alpha, col = "blue", lty = 2, lwd = 2)
# Close the file
dev.off()
}
# Reset graphics parameters
par(opar2)
opar2 <- par(mfrow = c(1, 1))
# Loop over each permutation
for (i in 1:perm) {
# Set file name
png(filename = paste0("Tukey_plot_", i, ".png"), width = 800, height = 600)
# Make the plot
plot(t.seq, Tukey.posthoc[, i], type = "l", col = "purple", lwd = 2,
main = paste("Tukey HSD p-values for", colnames(Tukey.posthoc)[i]),
xlab = "Time", ylab = "p-value", ylim = c(0, 1),
cex.lab = 2,     # axis label size
cex.axis = 1.8,    # tick number size
cex.main = 2.5)
abline(h = alpha, col = "blue", lty = 2, lwd = 2)
# Close the file
dev.off()
}
# Reset graphics parameters
par(opar2)
library(funFEM)
install.packages("funFEM")
library(funFEM)
res_v = funFEM(smooth$df,K=3,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
smooth
res_v = funFEM(smooth,K=3,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
smooth <- smooth.basis(day,st,tD3fdPar)
res_v = funFEM(smooth$fd,K=3,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
plot(t(gait1fd$coefs) %*% res_v$U,col=res_v$cls,pch=19,main="Discriminative space")
plot(t(smooth$fd$coefs) %*% res_v$U,col=res_v$cls,pch=19,main="Discriminative space")
res_v = funFEM(smooth$fd,K=5,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
plot(t(smooth$fd$coefs) %*% res_v$U,col=res_v$cls,pch=19,main="Discriminative space")
group.label.gait1 <- factor(res_v$cls)
fANOVA.pointwise(data=data, groups=group.label.gait1,
t.seq=tsq, alpha=0.05)
group.label <- factor(res_v$cls)
fANOVA.pointwise(data=data, groups=group.label,
t.seq=tsq, alpha=0.05)
group_means <- t(apply(data, 1, function(x) {
tapply(x, group.label, mean)
}))
matplot(1:156, group_means, type = "l", lty = 1, col = colors,
xlab = "Time", ylab = "Mean Value", main = "Mean Curves per Group")
plot(1:156, group_means, type = "l", lty = 1, col = colors,
xlab = "Time", ylab = "Mean Value", main = "Mean Curves per Group")
matplot(1:156, group_means, type = "l", lty = 1, col = colors,
xlab = "Time", ylab = "Mean Value", main = "Mean Curves per Group")
colors <- rainbow(length(levels(group.label)))
# Plot all group means
n.groups <- length(levels(group.label))
# Colors for each group
colors <- rainbow(n.groups)  # or choose manually
# Now plot
matplot(1:156, group_means, type = "l", lty = 1, col = colors,
xlab = "Time", ylab = "Mean Value", main = "Mean Curves per Group")
col = colors, lty = 1, cex = 0.8)
p.values <- sapply(1:156, function(i) {
summary(aov(data[i, ] ~ group.label))[[1]][["Pr(>F)"]][1]
})
plot(1:156, p.values, type = "l", lwd = 2, col = "blue",
xlab = "Time", ylab = "P-value", main = "Pointwise ANOVA p-values")
library(fdANOVA)
install.packages("fdANOVA")
library(fdANOVA)
plotFANOVA(x = gait[,,1], group.label = group.label,
int = c(0.025, 0.975))
plotFANOVA(x = data,
group.label = group.label,
int = c(0.025, 0.975),
means = TRUE)
plotFANOVA(x = data, group.label = group.label,
int = c(0.025, 0.975))
plotFANOVA(x = data, group.label = group.label,
int = c(0.025, 0.975),separately = TRUE)
res_v = funFEM(smooth$fd,K=4,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
plot(t(smooth$fd$coefs) %*% res_v$U,col=res_v$cls,pch=19,main="Discriminative space")
data <- eval.fd(1:156, smooth$fd)
group.label <- factor(res_v$cls)
fANOVA.pointwise(data=data, groups=group.label,
t.seq=tsq, alpha=0.05)
plotFANOVA(x = data,
group.label = group.label,
int = c(0.025, 0.975),
means = TRUE)
plotFANOVA(x = data, group.label = group.label,
int = c(0.025, 0.975),separately = TRUE)
res_v = funFEM(smooth$fd,K=8,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
res_v = funFEM(smooth$fd,K=8,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
res_v = funFEM(smooth$fd,K=2,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
plot(t(smooth$fd$coefs) %*% res_v$U,col=res_v$cls,pch=19,main="Discriminative space")
data <- eval.fd(1:156, smooth$fd)
group.label <- factor(res_v$cls)
fANOVA.pointwise(data=data, groups=group.label,
t.seq=tsq, alpha=0.05)
group_means <- t(apply(data, 1, function(x) {
tapply(x, group.label, mean)
}))
colors <- rainbow(length(levels(group.label)))
# Plot all group means
n.groups <- length(levels(group.label))
# Colors for each group
colors <- rainbow(n.groups)
matplot(1:156, group_means, type = "l", lty = 1, col = colors,
xlab = "Time", ylab = "Mean Value", main = "Mean Curves per Group")
col = colors, lty = 1, cex = 0.8)
plotFANOVA(x = data,
group.label = group.label,
int = c(0.025, 0.975),
means = TRUE)
res_v = funFEM(smooth$fd,K=3,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
plot(t(smooth$fd$coefs) %*% res_v$U,col=res_v$cls,pch=19,main="Discriminative space")
data <- eval.fd(1:156, smooth$fd)
group.label <- factor(res_v$cls)
fANOVA.pointwise(data=data, groups=group.label,
t.seq=tsq, alpha=0.05)
res_v = funFEM(smooth$fd,K=5,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
plot(t(smooth$fd$coefs) %*% res_v$U,col=res_v$cls,pch=19,main="Discriminative space")
data <- eval.fd(1:156, smooth$fd)
group.label <- factor(res_v$cls)
fANOVA.pointwise(data=data, groups=group.label,
t.seq=tsq, alpha=0.05)
group_means <- t(apply(data, 1, function(x) {
tapply(x, group.label, mean)
}))
colors <- rainbow(length(levels(group.label)))
n.groups <- length(levels(group.label))
# Colors for each group
colors <- rainbow(n.groups)  # or choose manually
# Now plot
matplot(1:156, group_means, type = "l", lty = 1, col = colors,
xlab = "Time", ylab = "Mean Value", main = "Mean Curves per Group")
col = colors, lty = 1, cex = 0.8)
plot(1:156, p.values, type = "l", lwd = 2, col = "blue",
xlab = "Time", ylab = "P-value", main = "Pointwise ANOVA p-values")
plotFANOVA(x = data, group.label = group.label,
int = c(0.025, 0.975),separately = TRUE)
plotFANOVA(x = data,
group.label = group.label,
int = c(0.025, 0.975),
means = TRUE)
plotFANOVA(x = data, group.label = group.label,
int = c(0.025, 0.975),separately = TRUE)
plotFANOVA(x = data,
group.label = group.label,
int = c(0.025, 0.975))
plotFANOVA(x = data, group.label = group.label,
int = c(0.025, 0.975),separately = TRUE)
# Now plot
matplot(1:156, group_means, type = "l", lty = 1, col = colors,
xlab = "Time", ylab = "Mean Value", main = "Mean Curves per Group")
col = colors, lty = 1, cex = 0.8)
p.values <- sapply(1:156, function(i) {
summary(aov(data[i, ] ~ group.label))[[1]][["Pr(>F)"]][1]
})
plot(1:156, p.values, type = "l", lwd = 2, col = "blue",
xlab = "Time", ylab = "P-value", main = "Pointwise ANOVA p-values")
#
res_v = funFEM(smooth$fd,K=5,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
res_v = funFEM(smooth$fd,K=5,model="AkjBk",init="kmeans",lambda=0,disp=TRUE)
plot(t(smooth$fd$coefs) %*% res_v$U,col=res_v$cls,pch=19,main="Discriminative space")
data <- eval.fd(1:156, smooth$fd)
group.label <- factor(res_v$cls)
fANOVA.pointwise(data=data, groups=group.label,
t.seq=tsq, alpha=0.05)
group_means <- t(apply(data, 1, function(x) {
tapply(x, group.label, mean)
}))
colors <- rainbow(length(levels(group.label)))
# Plot all group means
n.groups <- length(levels(group.label))
# Colors for each group
colors <- rainbow(n.groups)  # or choose manually
# Now plot
matplot(1:156, group_means, type = "l", lty = 1, col = colors,
xlab = "Time", ylab = "Mean Value", main = "Mean Curves per Group")
col = colors, lty = 1, cex = 0.8)
p.values <- sapply(1:156, function(i) {
summary(aov(data[i, ] ~ group.label))[[1]][["Pr(>F)"]][1]
})
plot(1:156, p.values, type = "l", lwd = 2, col = "blue",
xlab = "Time", ylab = "P-value", main = "Pointwise ANOVA p-values")
plotFANOVA(x = data,
group.label = group.label,
int = c(0.025, 0.975),
means = TRUE)
